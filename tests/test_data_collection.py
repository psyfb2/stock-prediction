import os
import unittest
from unittest.mock import patch, MagicMock

import pandas as pd
import numpy as np
from yfinance import Ticker

from data_collection.historical_data import get_historical_data, _args_to_filename, CACHE_DIR

class TestDataCollection(unittest.TestCase):
    def setUp(self):
        # AAPL historical data for 2021-01-01 to 2023-01-01
        self.data_2021_01_01_2023_01_01 = {"t":{"0":1609718400000,"1":1609804800000,"2":1609891200000,"3":1609977600000,"4":1610064000000,"5":1610323200000,"6":1610409600000,"7":1610496000000,"8":1610582400000,"9":1610668800000,"10":1611014400000,"11":1611100800000,"12":1611187200000,"13":1611273600000,"14":1611532800000,"15":1611619200000,"16":1611705600000,"17":1611792000000,"18":1611878400000,"19":1612137600000,"20":1612224000000,"21":1612310400000,"22":1612396800000,"23":1612483200000,"24":1612742400000,"25":1612828800000,"26":1612915200000,"27":1613001600000,"28":1613088000000,"29":1613433600000,"30":1613520000000,"31":1613606400000,"32":1613692800000,"33":1613952000000,"34":1614038400000,"35":1614124800000,"36":1614211200000,"37":1614297600000,"38":1614556800000,"39":1614643200000,"40":1614729600000,"41":1614816000000,"42":1614902400000,"43":1615161600000,"44":1615248000000,"45":1615334400000,"46":1615420800000,"47":1615507200000,"48":1615766400000,"49":1615852800000,"50":1615939200000,"51":1616025600000,"52":1616112000000,"53":1616371200000,"54":1616457600000,"55":1616544000000,"56":1616630400000,"57":1616716800000,"58":1616976000000,"59":1617062400000,"60":1617148800000,"61":1617235200000,"62":1617580800000,"63":1617667200000,"64":1617753600000,"65":1617840000000,"66":1617926400000,"67":1618185600000,"68":1618272000000,"69":1618358400000,"70":1618444800000,"71":1618531200000,"72":1618790400000,"73":1618876800000,"74":1618963200000,"75":1619049600000,"76":1619136000000,"77":1619395200000,"78":1619481600000,"79":1619568000000,"80":1619654400000,"81":1619740800000,"82":1620000000000,"83":1620086400000,"84":1620172800000,"85":1620259200000,"86":1620345600000,"87":1620604800000,"88":1620691200000,"89":1620777600000,"90":1620864000000,"91":1620950400000,"92":1621209600000,"93":1621296000000,"94":1621382400000,"95":1621468800000,"96":1621555200000,"97":1621814400000,"98":1621900800000,"99":1621987200000,"100":1622073600000,"101":1622160000000,"102":1622505600000,"103":1622592000000,"104":1622678400000,"105":1622764800000,"106":1623024000000,"107":1623110400000,"108":1623196800000,"109":1623283200000,"110":1623369600000,"111":1623628800000,"112":1623715200000,"113":1623801600000,"114":1623888000000,"115":1623974400000,"116":1624233600000,"117":1624320000000,"118":1624406400000,"119":1624492800000,"120":1624579200000,"121":1624838400000,"122":1624924800000,"123":1625011200000,"124":1625097600000,"125":1625184000000,"126":1625529600000,"127":1625616000000,"128":1625702400000,"129":1625788800000,"130":1626048000000,"131":1626134400000,"132":1626220800000,"133":1626307200000,"134":1626393600000,"135":1626652800000,"136":1626739200000,"137":1626825600000,"138":1626912000000,"139":1626998400000,"140":1627257600000,"141":1627344000000,"142":1627430400000,"143":1627516800000,"144":1627603200000,"145":1627862400000,"146":1627948800000,"147":1628035200000,"148":1628121600000,"149":1628208000000,"150":1628467200000,"151":1628553600000,"152":1628640000000,"153":1628726400000,"154":1628812800000,"155":1629072000000,"156":1629158400000,"157":1629244800000,"158":1629331200000,"159":1629417600000,"160":1629676800000,"161":1629763200000,"162":1629849600000,"163":1629936000000,"164":1630022400000,"165":1630281600000,"166":1630368000000,"167":1630454400000,"168":1630540800000,"169":1630627200000,"170":1630972800000,"171":1631059200000,"172":1631145600000,"173":1631232000000,"174":1631491200000,"175":1631577600000,"176":1631664000000,"177":1631750400000,"178":1631836800000,"179":1632096000000,"180":1632182400000,"181":1632268800000,"182":1632355200000,"183":1632441600000,"184":1632700800000,"185":1632787200000,"186":1632873600000,"187":1632960000000,"188":1633046400000,"189":1633305600000,"190":1633392000000,"191":1633478400000,"192":1633564800000,"193":1633651200000,"194":1633910400000,"195":1633996800000,"196":1634083200000,"197":1634169600000,"198":1634256000000,"199":1634515200000,"200":1634601600000,"201":1634688000000,"202":1634774400000,"203":1634860800000,"204":1635120000000,"205":1635206400000,"206":1635292800000,"207":1635379200000,"208":1635465600000,"209":1635724800000,"210":1635811200000,"211":1635897600000,"212":1635984000000,"213":1636070400000,"214":1636329600000,"215":1636416000000,"216":1636502400000,"217":1636588800000,"218":1636675200000,"219":1636934400000,"220":1637020800000,"221":1637107200000,"222":1637193600000,"223":1637280000000,"224":1637539200000,"225":1637625600000,"226":1637712000000,"227":1637884800000,"228":1638144000000,"229":1638230400000,"230":1638316800000,"231":1638403200000,"232":1638489600000,"233":1638748800000,"234":1638835200000,"235":1638921600000,"236":1639008000000,"237":1639094400000,"238":1639353600000,"239":1639440000000,"240":1639526400000,"241":1639612800000,"242":1639699200000,"243":1639958400000,"244":1640044800000,"245":1640131200000,"246":1640217600000,"247":1640563200000,"248":1640649600000,"249":1640736000000,"250":1640822400000,"251":1640908800000,"252":1641168000000,"253":1641254400000,"254":1641340800000,"255":1641427200000,"256":1641513600000,"257":1641772800000,"258":1641859200000,"259":1641945600000,"260":1642032000000,"261":1642118400000,"262":1642464000000,"263":1642550400000,"264":1642636800000,"265":1642723200000,"266":1642982400000,"267":1643068800000,"268":1643155200000,"269":1643241600000,"270":1643328000000,"271":1643587200000,"272":1643673600000,"273":1643760000000,"274":1643846400000,"275":1643932800000,"276":1644192000000,"277":1644278400000,"278":1644364800000,"279":1644451200000,"280":1644537600000,"281":1644796800000,"282":1644883200000,"283":1644969600000,"284":1645056000000,"285":1645142400000,"286":1645488000000,"287":1645574400000,"288":1645660800000,"289":1645747200000,"290":1646006400000,"291":1646092800000,"292":1646179200000,"293":1646265600000,"294":1646352000000,"295":1646611200000,"296":1646697600000,"297":1646784000000,"298":1646870400000,"299":1646956800000,"300":1647216000000,"301":1647302400000,"302":1647388800000,"303":1647475200000,"304":1647561600000,"305":1647820800000,"306":1647907200000,"307":1647993600000,"308":1648080000000,"309":1648166400000,"310":1648425600000,"311":1648512000000,"312":1648598400000,"313":1648684800000,"314":1648771200000,"315":1649030400000,"316":1649116800000,"317":1649203200000,"318":1649289600000,"319":1649376000000,"320":1649635200000,"321":1649721600000,"322":1649808000000,"323":1649894400000,"324":1650240000000,"325":1650326400000,"326":1650412800000,"327":1650499200000,"328":1650585600000,"329":1650844800000,"330":1650931200000,"331":1651017600000,"332":1651104000000,"333":1651190400000,"334":1651449600000,"335":1651536000000,"336":1651622400000,"337":1651708800000,"338":1651795200000,"339":1652054400000,"340":1652140800000,"341":1652227200000,"342":1652313600000,"343":1652400000000,"344":1652659200000,"345":1652745600000,"346":1652832000000,"347":1652918400000,"348":1653004800000,"349":1653264000000,"350":1653350400000,"351":1653436800000,"352":1653523200000,"353":1653609600000,"354":1653955200000,"355":1654041600000,"356":1654128000000,"357":1654214400000,"358":1654473600000,"359":1654560000000,"360":1654646400000,"361":1654732800000,"362":1654819200000,"363":1655078400000,"364":1655164800000,"365":1655251200000,"366":1655337600000,"367":1655424000000,"368":1655769600000,"369":1655856000000,"370":1655942400000,"371":1656028800000,"372":1656288000000,"373":1656374400000,"374":1656460800000,"375":1656547200000,"376":1656633600000,"377":1656979200000,"378":1657065600000,"379":1657152000000,"380":1657238400000,"381":1657497600000,"382":1657584000000,"383":1657670400000,"384":1657756800000,"385":1657843200000,"386":1658102400000,"387":1658188800000,"388":1658275200000,"389":1658361600000,"390":1658448000000,"391":1658707200000,"392":1658793600000,"393":1658880000000,"394":1658966400000,"395":1659052800000,"396":1659312000000,"397":1659398400000,"398":1659484800000,"399":1659571200000,"400":1659657600000,"401":1659916800000,"402":1660003200000,"403":1660089600000,"404":1660176000000,"405":1660262400000,"406":1660521600000,"407":1660608000000,"408":1660694400000,"409":1660780800000,"410":1660867200000,"411":1661126400000,"412":1661212800000,"413":1661299200000,"414":1661385600000,"415":1661472000000,"416":1661731200000,"417":1661817600000,"418":1661904000000,"419":1661990400000,"420":1662076800000,"421":1662422400000,"422":1662508800000,"423":1662595200000,"424":1662681600000,"425":1662940800000,"426":1663027200000,"427":1663113600000,"428":1663200000000,"429":1663286400000,"430":1663545600000,"431":1663632000000,"432":1663718400000,"433":1663804800000,"434":1663891200000,"435":1664150400000,"436":1664236800000,"437":1664323200000,"438":1664409600000,"439":1664496000000,"440":1664755200000,"441":1664841600000,"442":1664928000000,"443":1665014400000,"444":1665100800000,"445":1665360000000,"446":1665446400000,"447":1665532800000,"448":1665619200000,"449":1665705600000,"450":1665964800000,"451":1666051200000,"452":1666137600000,"453":1666224000000,"454":1666310400000,"455":1666569600000,"456":1666656000000,"457":1666742400000,"458":1666828800000,"459":1666915200000,"460":1667174400000,"461":1667260800000,"462":1667347200000,"463":1667433600000,"464":1667520000000,"465":1667779200000,"466":1667865600000,"467":1667952000000,"468":1668038400000,"469":1668124800000,"470":1668384000000,"471":1668470400000,"472":1668556800000,"473":1668643200000,"474":1668729600000,"475":1668988800000,"476":1669075200000,"477":1669161600000,"478":1669334400000,"479":1669593600000,"480":1669680000000,"481":1669766400000,"482":1669852800000,"483":1669939200000,"484":1670198400000,"485":1670284800000,"486":1670371200000,"487":1670457600000,"488":1670544000000,"489":1670803200000,"490":1670889600000,"491":1670976000000,"492":1671062400000,"493":1671148800000,"494":1671408000000,"495":1671494400000,"496":1671580800000,"497":1671667200000,"498":1671753600000,"499":1672099200000,"500":1672185600000,"501":1672272000000,"502":1672358400000},"o":{"0":131.2028511551,"1":126.6531703633,"2":125.5034892852,"3":126.1323641352,"4":130.1317416669,"5":126.9479927361,"6":126.269946394,"7":126.5254295196,"8":128.530035718,"9":126.54508599,"10":125.5624522461,"11":126.4271973381,"12":131.4779759377,"13":133.9149202079,"14":140.5871030914,"15":141.1079035399,"16":140.9408393112,"17":137.0986974476,"18":133.4727398984,"19":131.4288568057,"20":133.3744563517,"21":133.4039465487,"22":133.9345810431,"23":135.1680409175,"24":133.8690212933,"25":134.4496295077,"26":134.3118620753,"27":133.7410483777,"28":132.2156971417,"29":133.3376075971,"30":129.1649496544,"31":127.147513988,"32":128.1710171693,"33":125.9764233454,"34":121.7939351806,"35":122.9551979145,"36":122.6993224855,"37":120.6425298344,"38":121.7840970917,"39":126.3700674269,"40":122.8272466068,"41":119.8158629266,"42":119.0580991294,"43":119.0088899284,"44":117.1390715402,"45":119.7568237482,"46":120.5933174625,"47":118.4873183628,"48":119.4812708046,"49":123.7031045183,"50":122.0793257239,"51":120.9279158453,"52":117.9952575111,"53":118.4184384173,"54":121.3707736652,"55":120.8688621899,"56":117.6409859742,"57":118.4381005736,"58":119.7174577154,"59":118.2019098856,"60":119.7174538679,"61":121.6955316734,"62":121.9021979979,"63":124.4904186749,"64":123.8310636866,"65":126.9014887669,"66":127.7379845844,"67":130.4147855106,"68":130.3360564067,"69":132.7963155911,"70":131.6941519261,"71":132.1664923787,"72":131.3890332858,"73":132.8750528554,"74":130.2573070026,"75":130.9265258382,"76":130.0604980923,"77":132.6880871207,"78":132.8652117284,"79":132.1763304334,"80":134.302049344,"81":129.6865211704,"82":129.9424064989,"83":129.1059064662,"84":127.1475110769,"85":125.8583231402,"86":128.9900329496,"87":127.5704984916,"88":121.7445078783,"89":121.6459444553,"90":122.8091630197,"91":124.4554270348,"92":125.0173131915,"93":124.7610096745,"94":121.4093518521,"95":123.4499228059,"96":126.0030907359,"97":124.218832381,"98":126.0031046487,"99":125.1553196304,"100":124.6427213359,"101":123.7850907094,"102":123.3020591878,"103":122.5134067166,"104":122.9077303596,"105":122.3064183108,"106":124.3765561176,"107":124.8004366834,"108":125.4017635041,"109":125.2144665637,"110":124.7314358685,"111":126.003119303,"112":128.0929951856,"113":128.5168465403,"114":127.9549831525,"115":128.8520372104,"116":128.4478474306,"117":130.2518369398,"118":131.8685422405,"119":132.5388823692,"120":131.5629417143,"121":131.5136298571,"122":132.8839152217,"123":134.234389484,"124":134.6582969235,"125":135.9398196933,"126":138.0789876866,"127":141.4996569114,"128":139.5675109399,"129":140.7208633997,"130":144.1317452207,"131":141.9826634198,"132":145.9948141407,"133":147.1186371678,"134":146.3497108581,"135":141.7066645293,"136":141.4208049846,"137":143.4613631056,"138":143.8655417191,"139":145.4526500478,"140":146.1624255937,"141":147.0003178034,"142":142.7516229501,"143":142.6332853639,"144":142.3277086105,"145":144.2795484164,"146":143.7373949229,"147":145.1766188237,"148":144.8907551024,"149":144.4858656785,"150":144.3377864983,"151":144.5747192267,"152":144.1896727154,"153":144.3278942593,"154":147.0724872435,"155":146.6479599097,"156":148.3164308904,"157":147.8919126541,"158":143.1826639884,"159":145.5619823398,"160":146.4208935805,"161":147.5463548307,"162":147.9017881884,"163":146.4604008617,"164":145.6014701054,"165":147.1021152039,"166":150.7155020989,"167":150.8833140106,"168":151.9100547597,"169":151.8014493772,"170":152.9960753357,"171":154.9804378392,"172":153.5094241195,"173":153.0256861231,"174":148.7113410314,"175":148.4349129587,"176":146.6676841246,"177":146.5492425669,"178":146.924408511,"179":141.9683702008,"180":142.0966738158,"181":142.6100568181,"182":144.7820474801,"183":143.8046539631,"184":143.6170580684,"185":141.4253450512,"186":140.6552661091,"187":141.8301222695,"188":140.0925456632,"189":139.9543292781,"190":137.7132313578,"191":137.6935110963,"192":141.2377623479,"193":142.1953995191,"194":140.4578364303,"195":141.4055968964,"196":139.4409412089,"197":140.299886289,"198":141.93873885,"199":141.6227844497,"200":145.1374487766,"201":146.8059305769,"202":146.9145399174,"203":147.7833134413,"204":146.7861727121,"205":147.427896986,"206":147.457508396,"207":147.9116760545,"208":145.3447680039,"209":147.0922387388,"210":146.7664078375,"211":148.4743844161,"212":149.649253087,"213":150.1741699026,"214":149.6995676833,"215":148.5032592939,"216":148.3252759213,"217":147.2772678943,"218":146.7532338507,"219":148.6713116122,"220":148.2461815827,"221":149.2942113928,"222":151.9735842853,"223":155.8690793172,"224":159.8535520392,"225":159.2998917026,"226":158.9340516494,"227":157.7673741414,"228":157.5696426852,"229":158.1826507115,"230":165.5880231025,"231":156.9467696592,"232":162.1671149879,"233":162.4340903937,"234":167.1699329666,"235":170.1855011797,"236":172.9340953976,"237":173.2307283095,"238":179.0739439296,"239":173.2702620095,"240":173.1318363532,"241":177.2547590651,"242":168.01034268,"243":166.3790022966,"244":169.6219434906,"245":171.0852035313,"246":173.8635000307,"247":175.0895028764,"248":178.1248000977,"249":177.3041537397,"250":177.442592914,"251":176.0781712625,"252":175.8211152552,"253":180.5668914717,"254":177.5809903573,"255":170.7490656466,"256":170.9369194901,"257":167.1699593385,"258":170.3733572176,"259":174.130435258,"260":173.7942685724,"261":169.4044309974,"262":169.5725256713,"263":168.0795579311,"264":165.0936792639,"265":162.5625902708,"266":158.2123188755,"267":157.1840556585,"268":161.6530048797,"269":160.6148795201,"270":163.8380335099,"271":168.2377678022,"272":172.0442536822,"273":172.7759240618,"274":172.5089610075,"275":169.9568333984,"276":171.125010111,"277":170.006349605,"278":174.2830091246,"279":172.3921858885,"280":170.6003074164,"281":165.6900980248,"282":169.2539698334,"283":170.1251593663,"284":169.3133661328,"285":168.1155146857,"286":163.3241100234,"287":163.8784939829,"288":151.0485693308,"289":162.1955317707,"290":161.4233708161,"291":163.0469105101,"292":162.7400115444,"293":166.7790611659,"294":162.8390154599,"295":161.7203738995,"296":157.2259100624,"297":159.8592366815,"298":158.5920704174,"299":157.3348130327,"300":149.9299017396,"301":149.385408389,"302":155.473720385,"303":157.0180380087,"304":158.8989639656,"305":161.8688365262,"306":163.8487742846,"307":166.3038831918,"308":169.343047528,"309":172.1347434336,"310":170.4419282042,"311":174.9165675678,"312":176.7579029914,"313":176.0550133406,"314":172.2832516449,"315":172.817850057,"316":175.7184295772,"317":170.6300258692,"318":169.4420870998,"319":170.0558370705,"320":167.0166462966,"321":166.3335906602,"322":165.7098989412,"323":168.9074861712,"324":162.2747414363,"325":163.3637161918,"326":167.0661405045,"327":167.2146469945,"328":164.7892476823,"329":159.5028336756,"330":160.6214914396,"331":154.3451254735,"332":157.6516064062,"333":160.2156047663,"334":155.1371037818,"335":156.5626503094,"336":158.0673821883,"337":162.2054424906,"338":154.6710407861,"339":153.600291708,"340":154.1852555525,"341":152.1825988561,"342":141.544691163,"343":143.3490660582,"344":144.3008174113,"345":147.5824087331,"346":145.5896659954,"347":138.6794732107,"348":137.8962602017,"349":136.6074112594,"350":139.6014998528,"351":137.2419362611,"352":136.2108626849,"353":144.1421885498,"354":147.7906132098,"355":148.613474659,"356":146.561250716,"357":145.6392067054,"358":145.7681184442,"359":143.1111197303,"360":147.3047984561,"361":145.8176984464,"362":139.0760381277,"363":131.7296473969,"364":131.9874096939,"365":133.1374391611,"366":130.9464236656,"367":128.9536904485,"368":132.2749331268,"369":133.6331480269,"370":135.6457454244,"371":138.6992942269,"372":141.4752660929,"373":140.9101879641,"374":136.280266482,"375":136.0720657188,"376":134.8724291707,"377":136.5875964967,"378":140.1368873466,"379":142.0602132309,"380":144.0132932866,"381":144.4197696293,"382":144.5090064977,"383":141.7627893354,"384":142.8434180492,"385":148.4945123299,"386":149.4462699552,"387":146.6504877998,"388":149.8230121421,"389":153.1739974824,"390":154.0563782373,"391":152.6882140433,"392":150.9532438204,"393":151.2705066264,"394":155.6327074919,"395":159.8561754626,"396":159.628146777,"397":158.7259578278,"398":159.4596156463,"399":164.5852128464,"400":162.034019929,"401":165.1712292217,"402":162.8381955163,"403":166.4717964979,"404":168.8346655311,"405":168.5963994395,"406":170.2841429038,"407":171.5350654874,"408":171.525139322,"409":172.4980603419,"410":171.7832329093,"411":168.4673142609,"412":165.8761265397,"413":166.1143975966,"414":167.5638621649,"415":169.3409902137,"416":159.9888399438,"417":160.9617993325,"418":159.1549052431,"419":155.5113422631,"420":158.5989611468,"421":155.3425890978,"422":153.7044726567,"423":153.5257569145,"424":154.3497802722,"425":158.4400982386,"426":158.7478546153,"427":153.6746757727,"428":153.5356804858,"429":150.1205012791,"430":148.2341663342,"431":152.2947039544,"432":156.2062924412,"433":151.282073863,"434":150.1006335228,"435":148.5816521091,"436":151.6394688843,"437":146.5762002773,"438":145.0472802162,"439":140.2620175083,"440":137.214159492,"441":143.9850047151,"442":143.0319402214,"443":144.7593926879,"444":141.5129562779,"445":139.4082489014,"446":138.8919457908,"447":138.1275168973,"448":134.0173593541,"449":143.2701839202,"450":140.053554621,"451":144.4417015728,"452":140.669077955,"453":141.9894976028,"454":141.8405570554,"455":146.1294282594,"456":149.0085520258,"457":149.8722799215,"458":147.0031108321,"459":147.1321780335,"460":152.0564421622,"461":153.9625868118,"462":147.8767536511,"463":141.0363977788,"464":141.3001941855,"465":136.3478751956,"466":139.629554913,"467":137.730142926,"468":140.4549240145,"469":145.0094667055,"470":148.1419470718,"471":151.3738839789,"472":148.301058026,"473":145.6160698896,"474":151.4634008642,"475":149.3253447851,"476":147.3066219399,"477":148.6192951811,"478":147.4856131661,"479":144.3332345525,"480":143.4879677913,"481":140.6140168226,"482":147.3861911685,"483":145.1486955542,"484":146.948634704,"485":146.2525268756,"486":141.399652947,"487":141.568720026,"488":141.5488194823,"489":141.9068003319,"490":148.669021218,"491":144.5420751063,"492":140.3256481385,"493":135.9302195982,"494":134.3590070519,"495":130.6596906673,"496":132.240826066,"497":133.603236916,"498":130.1922824763,"499":130.6497379026,"500":128.9492366749,"501":127.2785740732,"502":127.6962538314},"c":{"0":127.1641769409,"1":128.7363739014,"2":124.402923584,"3":128.64793396,"4":129.7583465576,"5":126.7416305542,"6":126.564743042,"7":128.6184692383,"8":126.6728363037,"9":124.9335479736,"10":125.6115875244,"11":129.7387084961,"12":134.4946899414,"13":136.6565093994,"14":140.4396972656,"15":140.6755371094,"16":139.594619751,"17":134.7108612061,"18":129.6699066162,"19":131.8120880127,"20":132.6473083496,"21":131.6155395508,"22":135.0056610107,"23":134.5874023438,"24":134.7350463867,"25":133.849319458,"26":133.2391815186,"27":132.983291626,"28":133.2194824219,"29":131.0741424561,"30":128.7614593506,"31":127.6494216919,"32":127.8068847656,"33":123.9983596802,"34":123.8605728149,"35":123.3586807251,"36":119.0679397583,"37":119.3336639404,"38":125.7599182129,"39":123.1323318481,"40":120.1209335327,"41":118.2215957642,"42":119.491104126,"43":114.5114898682,"44":119.166343689,"45":118.0739898682,"46":120.0225296021,"47":119.1073074341,"48":122.0202789307,"49":123.5751724243,"50":122.7780456543,"51":118.6152496338,"52":118.0838241577,"53":121.4298248291,"54":120.5933227539,"55":118.1822280884,"56":118.6743011475,"57":119.2844390869,"58":119.4615859985,"59":117.9952468872,"60":120.2095108032,"61":121.0460128784,"62":123.8999481201,"63":124.2050247192,"64":125.8681793213,"65":128.2890930176,"66":130.8871459961,"67":129.1551208496,"68":132.2944335938,"69":129.9325408936,"70":132.3633422852,"71":132.028717041,"72":132.6979064941,"73":130.9953918457,"74":131.379196167,"75":129.8440093994,"76":132.1861877441,"77":132.5798339844,"78":132.255065918,"79":131.4579315186,"80":131.3595428467,"81":129.3716125488,"82":130.434463501,"83":125.8189620972,"84":126.064994812,"85":127.6789398193,"86":128.3591308594,"87":125.0468826294,"88":124.1202545166,"89":121.0248947144,"90":123.1936187744,"91":125.6383666992,"92":124.4751281738,"93":123.0753173828,"94":122.9176025391,"95":125.5003509521,"96":123.647064209,"97":125.2933349609,"98":125.0961837769,"99":125.0468826294,"100":123.499206543,"101":122.8387374878,"102":122.5134277344,"103":123.2823181152,"104":121.7839355469,"105":124.1005477905,"106":124.1103973389,"107":124.9384460449,"108":125.3228988647,"109":124.3174057007,"110":125.5397796631,"111":128.6253051758,"112":127.7972564697,"113":128.2999725342,"114":129.9166870117,"115":128.6055908203,"116":130.419418335,"117":132.0755310059,"118":131.7995300293,"119":131.513671875,"120":131.2179107666,"121":132.864151001,"122":134.3921661377,"123":135.013168335,"124":135.3187713623,"125":137.9705505371,"126":140.0012664795,"127":142.5150299072,"128":141.203918457,"129":143.0473175049,"130":142.4460449219,"131":143.5697784424,"132":147.029876709,"133":146.369430542,"134":144.3091278076,"135":140.4251403809,"136":144.072555542,"137":143.3332061768,"138":144.7133178711,"139":146.4482879639,"140":146.8721923828,"141":144.6837310791,"142":142.9192047119,"143":143.5697784424,"144":143.7866668701,"145":143.4514923096,"146":145.2653656006,"147":144.8611602783,"148":144.969619751,"149":144.2785339355,"150":144.2291870117,"151":143.7454223633,"152":144.0020904541,"153":146.9934997559,"154":147.2008361816,"155":149.195098877,"156":148.2769470215,"157":144.4957275391,"158":144.8313903809,"159":146.3024291992,"160":147.8030700684,"161":147.7141876221,"162":146.4702606201,"163":145.6607055664,"164":146.7072143555,"165":151.169631958,"166":149.8960723877,"167":150.5673828125,"168":151.692855835,"169":152.3345794678,"170":154.6941680908,"171":153.134262085,"172":152.1075134277,"173":147.0724945068,"174":147.6450958252,"175":146.2333068848,"176":147.1316986084,"177":146.8947753906,"178":144.1995544434,"179":141.1193237305,"180":141.6030426025,"181":143.9922332764,"182":144.9597625732,"183":145.0485992432,"184":143.5183258057,"185":140.1024169922,"186":141.0106811523,"187":139.6976318359,"188":140.8329925537,"189":137.3677062988,"190":139.3125915527,"191":140.1912841797,"192":141.4648284912,"193":141.079788208,"194":140.9909515381,"195":139.7075042725,"196":139.1151428223,"197":141.9288635254,"198":142.9951019287,"199":144.683303833,"200":146.8651580811,"201":147.358795166,"202":147.5760040283,"203":146.7960510254,"204":146.7466888428,"205":147.4180297852,"206":146.9540100098,"207":150.6266479492,"208":147.8919067383,"209":147.0626220703,"210":148.109085083,"211":149.5603790283,"212":149.0371551514,"213":149.5710601807,"214":148.740524292,"215":149.1063690186,"216":146.2489929199,"217":146.1995697021,"218":148.2956237793,"219":148.3054962158,"220":149.2942047119,"221":151.7560882568,"222":156.0865783691,"223":158.736328125,"224":159.2010192871,"225":159.5866241455,"226":160.1106109619,"227":155.0385437012,"228":158.4298248291,"229":163.4326629639,"230":162.9086456299,"231":161.9100494385,"232":160.0117340088,"233":163.4524688721,"234":169.2462005615,"235":173.1021728516,"236":172.5880432129,"237":177.4228210449,"238":173.7547302246,"239":172.3606567383,"240":177.2745056152,"241":170.3140563965,"242":169.2066802979,"243":167.8323974609,"244":171.0357971191,"245":173.6558380127,"246":174.2886352539,"247":178.2929077148,"248":177.2646179199,"249":177.3535919189,"250":176.1869354248,"251":175.5640563965,"252":179.9538879395,"253":177.6699829102,"254":172.9439697266,"255":170.0569763184,"256":170.2250518799,"257":170.2448272705,"258":173.1021728516,"259":173.5471038818,"260":170.2448272705,"261":171.1148986816,"262":167.8818511963,"263":164.352142334,"264":162.6515808105,"265":160.575302124,"266":159.7942352295,"267":157.9750213623,"268":157.8860473633,"269":157.42137146,"270":168.4058380127,"271":172.8055725098,"272":172.6374816895,"273":173.8536071777,"274":170.9468078613,"275":170.6597137451,"276":169.9370574951,"277":173.0752410889,"278":174.5106964111,"279":170.3924560547,"280":166.9473419189,"281":167.1849517822,"282":171.0556945801,"283":170.8181304932,"284":167.1849517822,"285":165.620803833,"286":162.6707458496,"287":158.4634094238,"288":161.1065979004,"289":163.1954040527,"290":163.4626922607,"291":161.5619659424,"292":164.8882293701,"293":164.5615386963,"294":161.5322570801,"295":157.7011260986,"296":155.8597564697,"297":161.3144836426,"298":156.9289398193,"299":153.1769714355,"300":149.1082305908,"301":153.5333557129,"302":157.9882202148,"303":159.0078582764,"304":162.3341369629,"305":163.7200775146,"306":167.1255645752,"307":168.5016021729,"308":172.322845459,"309":172.9663085938,"310":173.8375091553,"311":177.1637878418,"312":175.9857330322,"313":172.8574371338,"314":172.5604400635,"315":176.6490020752,"316":173.3029174805,"317":170.1053466797,"318":170.4122467041,"319":168.3827972412,"320":164.0863494873,"321":165.9772033691,"322":168.6896820068,"323":163.6309814453,"324":163.4132080078,"325":165.7198181152,"326":165.5514984131,"327":164.7496337891,"328":160.1661071777,"329":161.2451782227,"330":155.2261962891,"331":154.9985046387,"332":161.997543335,"333":156.0676574707,"334":156.3745574951,"335":157.8793029785,"336":164.3536529541,"337":155.1965026855,"338":155.9301452637,"339":150.7549285889,"340":153.1839141846,"341":145.2426757812,"342":141.3364868164,"343":145.847442627,"344":144.2908935547,"345":147.9591522217,"346":139.6114196777,"347":136.1711883545,"348":136.4091339111,"349":141.8817596436,"350":139.1553649902,"351":139.3140106201,"352":142.5460205078,"353":148.3557128906,"354":147.5625762939,"355":147.4337005615,"356":149.9122467041,"357":144.1322631836,"358":144.8857574463,"359":147.4337005615,"360":146.6901245117,"361":141.415802002,"362":135.9530792236,"363":130.7481536865,"364":131.6205749512,"365":134.2676544189,"366":128.9437561035,"367":130.4308929443,"368":134.7039031982,"369":134.1883544922,"370":137.0832977295,"371":140.4441986084,"372":140.4441986084,"373":136.2604370117,"374":138.0350646973,"375":135.5466156006,"376":137.7376251221,"377":140.3450622559,"378":141.6934051514,"379":145.093963623,"380":145.7780151367,"381":143.6266326904,"382":144.6081542969,"383":144.2413330078,"384":147.1957397461,"385":148.8811645508,"386":145.8077697754,"387":149.7040557861,"388":151.7265319824,"389":154.016708374,"390":152.7675323486,"391":151.6373138428,"392":150.2989196777,"393":155.4443664551,"394":155.9995422363,"395":161.1152648926,"396":160.1238555908,"397":158.63671875,"398":164.7042236328,"399":164.386932373,"400":164.1585998535,"401":163.6820373535,"402":163.7317047119,"403":168.0205688477,"404":167.2759857178,"405":170.8599700928,"406":171.9421081543,"407":171.7832641602,"408":173.2923126221,"409":172.8951721191,"410":170.2841186523,"411":166.3625946045,"412":166.0250396729,"413":166.3228759766,"414":168.8048553467,"415":162.4410552979,"416":160.2171936035,"417":157.7649993896,"418":156.0871734619,"419":156.8218383789,"420":154.6873474121,"421":153.4165649414,"422":154.8362579346,"423":153.3470611572,"424":156.2360839844,"425":162.2524261475,"426":152.7315216064,"427":154.1909332275,"428":151.2721099854,"429":149.6141662598,"430":153.3669128418,"431":155.7694854736,"432":152.6123809814,"433":151.6394805908,"434":149.3460998535,"435":149.6836547852,"436":150.666519165,"437":148.760345459,"438":141.4533538818,"439":137.204208374,"440":141.4235992432,"441":145.0473022461,"442":145.3451385498,"443":144.3821258545,"444":139.0806121826,"445":139.4082489014,"446":137.9785766602,"447":137.3432006836,"448":141.9597167969,"449":137.3829193115,"450":141.383895874,"451":142.7142333984,"452":142.8234405518,"453":142.3568267822,"454":146.2088623047,"455":148.3731384277,"456":151.2423400879,"457":148.2738800049,"458":143.7566680908,"459":154.6178588867,"460":152.2351379395,"461":149.5644989014,"462":143.9850006104,"463":137.8793182373,"464":137.610824585,"465":138.1478118896,"466":138.724609375,"467":134.1203155518,"468":146.0536193848,"469":148.8678894043,"470":147.4557800293,"471":149.2059936523,"472":147.9629364014,"473":149.882232666,"474":150.4490661621,"475":147.187286377,"476":149.3452148438,"477":150.2303009033,"478":147.2867279053,"479":143.4183502197,"480":140.3853149414,"481":147.2071685791,"482":147.4856262207,"483":146.9884033203,"484":145.8149719238,"485":142.1156463623,"486":140.1566009521,"487":141.8571014404,"488":141.3698272705,"489":143.6868591309,"490":144.6614227295,"491":142.4139709473,"492":135.7412719727,"493":133.7623291016,"494":131.6342315674,"495":131.5646362305,"496":134.6970977783,"497":131.495010376,"498":131.1270599365,"499":129.3072357178,"500":125.3394165039,"501":128.8895721436,"502":129.2077941895},"h":{"0":131.2912856648,"1":129.4537158694,"2":128.7757007253,"3":129.3456187913,"4":130.3282827701,"5":127.9109812658,"6":127.4392969348,"7":129.1687483207,"8":128.7265618212,"9":127.9600979057,"10":126.4763204414,"11":130.1907321082,"12":137.2461004456,"13":137.4229716479,"14":142.5720362652,"15":141.7957524093,"16":141.795751107,"17":139.5258329097,"18":134.3669509009,"19":133.0305740269,"20":133.9443924847,"21":133.4137825998,"22":135.0154820676,"23":135.2369210772,"24":134.7842550882,"25":135.6896225704,"26":134.8137697793,"27":134.2232695058,"28":133.3769442363,"29":133.8493360512,"30":130.1195413408,"31":127.9348081182,"32":128.6335519665,"33":127.6592648339,"34":124.6970681064,"35":123.5653437513,"36":124.4510440423,"37":122.8666295432,"38":125.8976935605,"39":126.6751403283,"40":123.712950569,"41":121.6364720731,"42":120.0028475422,"43":119.0777775986,"44":120.1209353344,"45":120.229194219,"46":121.2526719695,"47":119.2450827833,"48":122.0301221718,"49":125.1989617335,"50":123.8605693844,"51":121.2231530247,"52":119.5009505691,"53":121.9022028487,"54":122.2663134437,"55":120.9475930995,"56":119.7273103131,"57":119.5501540315,"58":120.6326839449,"59":118.4873037904,"60":121.5577420008,"61":122.2072676112,"62":124.1558198501,"63":125.1104077804,"64":125.8878582972,"65":128.3186152343,"66":130.9265039441,"67":130.7395449177,"68":132.5207906183,"69":132.8553600152,"70":132.8553993197,"71":132.530609696,"72":133.3179030182,"73":133.3769455002,"74":131.6252246242,"75":132.018893028,"76":132.9734668599,"77":132.9144291271,"78":133.2588662967,"79":132.8750578828,"80":134.892523797,"81":131.4382426115,"82":131.9401717424,"83":129.401143643,"84":128.3776534344,"85":127.6887755522,"86":129.3941935548,"87":127.6986403714,"88":124.4751303733,"89":122.8683164925,"90":124.3568459996,"91":126.0721147526,"92":125.1257501951,"93":125.1848977376,"94":123.1443290037,"95":125.9045266216,"96":126.1805324105,"97":126.121398688,"98":126.4960049288,"99":125.5792076741,"100":125.8256609304,"101":124.0118246942,"102":123.5682179788,"103":123.4597597858,"104":123.0753120813,"105":124.3667141126,"106":124.5244254485,"107":126.6340057462,"108":125.9340885382,"109":126.3678412747,"110":125.6285042674,"111":128.6844499071,"112":128.7436173522,"113":129.029459195,"114":130.6658937488,"115":129.6406536252,"116":130.5278553364,"117":132.1741155681,"118":132.410727322,"119":132.7261840561,"120":131.9868222665,"121":133.3274713284,"122":134.5498954596,"123":135.4567687347,"124":135.3779160819,"125":138.0099753402,"126":141.1151939102,"127":142.8304734741,"128":142.0122547339,"129":143.5796349932,"130":144.240182258,"131":145.3639150079,"132":147.4439197866,"133":147.8678287517,"134":147.6312198775,"135":142.022123107,"136":145.0090638703,"137":144.0528404244,"138":146.0934115874,"139":146.6060172501,"140":147.7002486228,"141":147.0890499235,"142":144.8809236444,"143":144.4668467251,"144":144.2499872367,"145":144.8611581789,"146":145.9356925838,"147":145.6892163972,"148":145.7385312722,"149":145.2361797178,"150":144.8314177894,"151":145.8285467878,"152":144.8511366982,"153":147.1514653571,"154":147.5365017966,"155":149.2642144804,"156":149.7479584034,"157":148.8001922674,"158":146.1148345077,"159":146.6084781575,"160":148.2769518329,"161":148.9383983562,"162":148.4053016892,"163":147.2205821557,"164":146.8552977055,"165":151.5349293335,"166":150.8537182511,"167":153.0059221394,"168":152.7492337928,"169":152.6603778421,"170":155.2568998989,"171":155.0396711693,"172":154.1215219395,"173":153.4995679008,"174":149.4912717037,"175":149.1457431162,"176":147.5364797648,"177":147.0724904676,"178":146.924408511,"179":142.9951167148,"180":142.7581528982,"181":144.5648322364,"182":145.2065782117,"183":145.5915966107,"184":144.1008220525,"185":142.9062387167,"186":142.6100413148,"187":142.5409524141,"188":141.0995576523,"189":140.3986094633,"190":140.4282028348,"191":140.3393675386,"192":142.3829903945,"193":142.3434828504,"194":142.9654764866,"195":141.4253463635,"196":139.5988917376,"197":142.0473452792,"198":143.0543352705,"199":144.9696032929,"200":147.269939305,"201":147.8425592137,"202":147.7339696542,"203":148.2670623838,"204":147.4673862077,"205":148.9186577968,"206":147.8227906528,"207":151.2189964149,"208":148.0301228682,"209":147.7931866465,"210":149.639344564,"211":150.0342607389,"212":150.4884171819,"213":150.4806655654,"214":149.8577638293,"215":149.7193603469,"216":148.4340338897,"217":147.7419446216,"218":148.700980695,"219":150.1642632627,"220":149.7786747808,"221":153.2490249397,"222":156.8775439921,"223":159.201019913,"224":163.8281437715,"225":159.9722178795,"226":160.3083485999,"227":158.6374226836,"228":159.3690899623,"229":163.6501789027,"230":168.3761736272,"231":162.3450813109,"232":163.0964984779,"233":165.9835474029,"234":169.6416908794,"235":173.9722365695,"236":174.7533058233,"237":177.6007955008,"238":180.0725439573,"239":175.732138781,"240":177.472243259,"241":179.0937481452,"242":171.5103607719,"243":168.6530230704,"244":171.2434163732,"245":173.8733539343,"246":174.852203437,"247":178.381887411,"248":179.281581213,"249":178.5894709682,"250":178.5301726426,"251":177.2052924478,"252":180.8140700966,"253":180.8733870859,"254":178.1346617605,"255":173.3197003929,"256":172.1727986625,"257":170.5513228862,"258":173.2010341282,"259":175.1784584318,"260":174.6247757414,"261":171.8168696226,"262":170.5908890322,"263":169.147359286,"264":167.763175261,"265":164.4510171423,"266":160.4665613719,"267":160.9213531455,"268":162.5329502967,"269":161.9891767728,"270":168.4256163033,"271":173.0230884565,"272":172.8648792215,"273":173.8931637633,"274":174.2490886064,"275":172.35255705,"276":172.2040661892,"277":173.5900261022,"278":174.8769779293,"279":173.7187329114,"280":171.3427795873,"281":167.8779228425,"282":171.2140922803,"283":171.6001946708,"284":170.1845383832,"285":168.8282741094,"286":165.0169535918,"287":164.4823721115,"288":161.215494444,"289":163.4626831825,"290":163.7596841937,"291":164.9278493592,"292":165.6802027649,"293":167.2146472854,"294":163.8883737982,"295":163.3637162839,"296":161.2451568925,"297":161.7698733137,"298":158.7801658053,"299":157.6813061265,"300":152.5731012852,"301":154.0085488217,"302":158.3941087439,"303":159.3840490645,"304":162.8291184887,"305":164.6803427847,"306":167.7195333248,"307":170.9072049164,"308":172.3921350055,"309":173.5206853672,"310":173.9661940737,"311":177.213273908,"312":177.807261392,"313":176.2431087243,"314":173.1247261979,"315":176.6985032469,"316":176.5104029851,"317":171.8872831278,"318":171.6200028894,"319":170.0558370705,"320":167.3334265674,"321":168.1650131817,"322":169.3232576958,"323":169.5509711996,"324":164.9278502667,"325":166.1356159133,"326":167.1849463293,"327":169.8083451127,"328":166.1850840324,"329":161.5322608461,"330":160.7105844813,"331":158.1861714057,"332":162.8687156013,"333":164.5318439554,"334":156.6418366211,"335":159.096968406,"336":164.8090274513,"337":162.4331297495,"338":158.0716107228,"339":154.4925764516,"340":155.3947861262,"341":154.1158601157,"342":144.9452461778,"343":146.8289514895,"344":146.2539110595,"345":148.4846022832,"346":146.0952834746,"347":140.4441950038,"348":139.4924430253,"349":142.0304662181,"350":140.7515478172,"351":140.5731001274,"352":143.1012119402,"353":148.3953629341,"354":149.3669633958,"355":150.437694325,"356":149.9717293336,"357":146.7000305607,"358":147.2949099143,"359":147.7212049754,"360":148.5837202402,"361":146.6802268939,"362":139.551914266,"363":134.0396521453,"364":132.7408815083,"365":136.1612653287,"366":131.2537606665,"367":131.9378518849,"368":135.8836925515,"369":136.5776589887,"370":137.4005434532,"371":140.6920529692,"372":142.2584943445,"373":142.1891100086,"374":139.4627084254,"375":137.1824485909,"376":137.8466816515,"377":140.3946361576,"378":142.8831032758,"379":145.2922441063,"380":146.2836477178,"381":145.3814457095,"382":147.1759219404,"383":145.1930853064,"384":147.6716158531,"385":149.565245048,"386":150.2691482436,"387":149.9320775956,"388":152.4007037686,"389":154.2348214253,"390":154.9387392846,"391":153.7093729271,"392":151.7761222737,"393":155.9797404569,"394":156.2870466414,"395":162.2256628651,"396":162.1860060716,"397":161.016129977,"398":165.160267293,"399":165.7550933566,"400":164.6549971737,"401":166.6008558389,"402":164.6252290564,"403":168.1198392215,"404":169.7579724865,"405":170.9294578428,"406":172.1406640549,"407":172.4583724274,"408":174.8807750042,"409":173.6397680631,"410":172.4881236772,"411":168.6360875212,"412":167.4943866142,"413":166.898698655,"414":168.9140633526,"415":169.8175274026,"416":161.7262304526,"417":161.3886937549,"418":159.4229640358,"419":157.2785154019,"420":159.2045665497,"421":155.9581169688,"422":155.541133642,"423":155.2333648448,"424":156.682853681,"425":163.076447544,"426":159.3832425699,"427":155.9680441178,"428":154.1214408193,"429":150.2594919386,"430":153.4463382314,"431":156.9409911204,"432":157.5962139145,"433":153.3570113235,"434":150.3786148277,"435":152.6620387583,"436":153.605198161,"437":149.554584202,"438":145.6628079489,"439":142.0689109212,"440":142.0391422464,"441":145.1664327547,"442":146.3180882665,"443":146.4769232761,"444":142.0689340601,"445":140.8676585206,"446":140.3315099484,"447":139.3486500079,"448":142.5553845158,"449":143.4786774482,"450":141.8703555784,"451":145.6429746367,"452":143.9055830966,"453":144.8388134512,"454":146.78468498,"455":149.1475169437,"456":151.3912683813,"457":150.8948571506,"458":147.9760453457,"459":156.3651721826,"460":153.1286622721,"461":154.3299159624,"462":151.0735534969,"463":141.7710712329,"464":141.8769720972,"465":138.3765291868,"466":140.6438744649,"467":137.779868034,"468":146.0536193848,"469":149.1761638412,"470":149.4446629703,"471":152.736263957,"472":149.0369349863,"473":150.6380027866,"474":151.8512324895,"475":149.5341690104,"476":149.5838862626,"477":150.9860710623,"478":148.052452092,"479":145.8248967596,"480":144.0050816576,"481":147.8933356165,"482":148.3010755883,"483":147.177349643,"484":150.0811195726,"485":146.4812441847,"486":142.5730867466,"487":142.7222760317,"488":144.7608769067,"489":143.6967980833,"490":149.1364099902,"491":145.8447910165,"492":141.0118152379,"493":136.8848750007,"494":134.4485031554,"495":132.509352784,"496":136.0495388216,"497":133.8120611576,"498":131.683944762,"499":130.6795699356,"500":130.3016778182,"501":129.7547314514,"502":129.2276872708},"l":{"0":124.5601644736,"1":126.2011468629,"2":124.1867403662,"3":125.6410414352,"4":127.9699244777,"5":126.2699648449,"6":124.6584083783,"7":126.2601260296,"8":126.5254304808,"9":124.7959782037,"10":124.7370335494,"11":126.3191057131,"12":131.2716137774,"13":132.6767923435,"14":134.1704139898,"15":138.9165932211,"16":137.9732606455,"17":134.3276300801,"18":127.9502769933,"19":128.657788852,"20":132.2738982984,"21":131.2912647393,"22":132.254250686,"23":133.7017059009,"24":132.7766541929,"25":133.6918726543,"26":132.2649033429,"27":131.6448963678,"28":131.5661784194,"29":130.6804878571,"30":127.4132281099,"31":125.3859566988,"32":126.753890558,"33":123.6047125923,"34":116.5092409729,"35":120.2882500413,"36":118.6250915025,"37":119.2746119957,"38":120.8393486334,"39":123.0240787203,"40":119.9044272855,"41":116.7355892356,"42":115.7022672334,"43":114.3638712869,"44":116.9028863162,"45":117.5524031906,"46":119.3336528796,"47":117.2670191951,"48":118.5069926491,"49":122.7386771766,"50":120.3964844383,"51":118.4085866115,"52":117.7787512529,"53":118.3495507382,"54":120.1996756774,"55":118.1625491151,"56":117.1095635245,"57":117.0308174651,"58":118.8120747273,"59":116.9717676276,"60":119.2253969326,"61":120.5441126739,"62":121.1149038326,"63":123.6539232922,"64":123.152022639,"65":126.4783269832,"66":127.4132252022,"67":128.5548107365,"68":129.8341486722,"69":129.568423601,"70":131.5170035851,"71":131.1626920522,"72":131.2217357351,"73":129.7160408699,"74":129.2141487465,"75":129.3224301573,"76":130.0604980923,"77":131.4382581861,"78":131.9795152283,"79":130.9658745874,"80":130.3459065483,"81":128.9878087503,"82":129.7357509672,"83":124.6872295972,"84":125.9370552016,"85":125.1103944913,"86":127.6394966462,"87":125.0074503089,"88":121.0248811622,"89":120.5122895119,"90":122.4937119513,"91":124.0611113063,"92":123.3907656594,"93":123.0063126991,"94":121.113613179,"95":123.3217658762,"96":123.4301902156,"97":124.1498276972,"98":124.5244263712,"99":124.6229945857,"100":123.3020524509,"101":122.7795927617,"102":122.1782642553,"103":122.2866802893,"104":121.3797599018,"105":122.0895442768,"106":123.0556071429,"107":124.4159809589,"108":124.7215691515,"109":124.1498239765,"110":124.3075478102,"111":125.2637800783,"112":127.5508100468,"113":126.6340077299,"114":127.8071062767,"115":128.3887167937,"116":127.3733448977,"117":129.7490767311,"118":131.3362095999,"119":131.0404839159,"120":130.9221721031,"121":131.4544851416,"122":132.4403146656,"123":133.9386508702,"124":133.8302257233,"125":135.7919578794,"126":138.0789876866,"127":140.6321758211,"128":138.6704425374,"129":140.6222788447,"130":141.9531520329,"131":141.5883552947,"132":145.5807710631,"133":144.9991892639,"134":143.8063826558,"135":139.6562289002,"136":140.9279121979,"137":142.5741621693,"138":143.7373847877,"139":144.8316003843,"140":145.6005206183,"141":143.4810716569,"142":140.5138852286,"143":142.5248483732,"144":142.0615423262,"145":143.185326046,"146":143.1163451858,"147":144.200685871,"148":144.0922712181,"149":143.7750355089,"150":143.6664551734,"151":143.4492406079,"152":143.676292063,"153":143.9823463897,"154":146.3814065468,"155":144.6043344409,"156":147.1909523209,"157":144.2883958037,"158":142.659416124,"159":144.9103854881,"160":146.0062451535,"161":147.2501731136,"162":145.9173960473,"163":145.631088896,"164":144.9597555025,"165":146.7170834244,"166":149.3629421831,"167":150.3995500127,"168":150.458777883,"169":151.1399854285,"170":152.4234612611,"171":152.0186508207,"172":151.9890317051,"173":146.8059294162,"174":146.8552828875,"175":145.0387277759,"176":144.5055772884,"177":145.3447811556,"178":143.9033726885,"179":139.4705969346,"180":140.9613280511,"181":141.8696099862,"182":143.784917724,"183":143.705921691,"184":141.9880811848,"185":139.8852180494,"186":140.2208682713,"187":139.4804328993,"188":137.3380898587,"189":136.5087927279,"190":137.584882431,"191":136.6075162494,"192":140.9020967335,"193":140.744122614,"194":140.0036890638,"195":139.2434897145,"196":137.4269175576,"197":139.7075227134,"198":141.6820409497,"199":141.3364849898,"200":144.6833164812,"201":146.2333165198,"202":145.9865106958,"203":146.7466848917,"204":145.7396769334,"205":147.111965785,"206":146.5985949535,"207":147.812943778,"208":144.5450878907,"209":145.9173940059,"210":146.7565255739,"211":147.9116527093,"212":148.7212239172,"213":148.3648407368,"214":148.4636885797,"215":148.3648414105,"216":146.1797915326,"217":146.0117136388,"218":145.8139686673,"219":147.7419280887,"220":147.6529535427,"221":149.2843297901,"222":151.3210365149,"223":154.7617363771,"224":159.1812409957,"225":157.2631650521,"226":157.8365904094,"227":154.5936302861,"228":156.9961929514,"229":158.1134342372,"230":162.6713514087,"231":156.0173861293,"232":157.9156878986,"233":162.4242087899,"234":166.4382871934,"235":168.771647638,"236":171.9552737132,"237":172.7165983204,"238":173.5470958854,"239":170.2646104649,"240":170.3634640817,"241":168.8211195696,"242":167.7730635459,"243":165.5682733762,"244":167.2095049144,"245":170.2052582433,"246":173.2900502447,"247":175.0697396682,"248":176.5132088011,"249":176.1275944709,"250":176.0781774519,"251":175.2575456936,"252":175.702475683,"253":177.0965331764,"254":172.667134025,"255":169.7010425087,"256":169.0979306781,"257":166.2702356956,"258":168.8903022909,"259":172.8451329272,"260":169.8493368902,"261":169.157255156,"262":167.4962574488,"263":164.0654250202,"264":162.3253068984,"265":160.4665441606,"266":152.9524096596,"267":155.2462055249,"268":156.0371768446,"269":156.4919877621,"270":160.960903233,"271":167.5951015646,"272":170.3634611102,"273":171.3719670043,"274":170.1756204341,"275":168.9668704403,"276":169.2341770968,"277":169.7093576702,"278":173.1445424809,"279":169.8281849025,"280":166.35335814,"281":164.8882304332,"282":168.541195288,"283":168.3432228219,"284":166.7790633378,"285":164.5219443591,"286":160.5225126031,"287":158.1466139636,"288":150.4743889288,"289":159.255340498,"290":160.7996892674,"291":160.3443156265,"292":161.3144624549,"293":163.8883711338,"294":160.47300455,"295":157.443726023,"296":154.2362179692,"297":157.8100209255,"298":154.4144253269,"299":152.9492841741,"300":148.593460678,"301":148.8706385129,"302":152.9097193751,"303":156.0478784613,"304":158.1564916769,"305":161.3738550512,"306":163.254805535,"307":165.9672843049,"308":168.5015881449,"309":171.0160805907,"310":170.2736363066,"311":174.5700744702,"312":174.9264653336,"313":172.6495382608,"314":170.2142326967,"315":172.6891500317,"316":172.6693417752,"317":168.4224125753,"318":168.1452378612,"319":167.5017308058,"320":163.8388587641,"321":164.9674368603,"322":165.096126741,"323":163.3834906895,"324":161.928263432,"325":162.2648565385,"326":164.4328505615,"327":164.2447581181,"328":159.8790245541,"329":156.8695435767,"330":155.146997439,"331":153.8204463241,"332":157.3348109982,"333":155.6716783217,"334":151.7316287457,"335":154.7510312209,"336":157.661493754,"337":153.3947627871,"338":152.8567449217,"339":150.189828533,"340":151.6174727018,"341":144.5585952291,"342":137.6087621872,"343":141.8817722572,"344":142.9425651752,"345":145.4211107302,"346":138.6993022648,"347":135.4276252913,"348":131.4718788624,"349":136.4686134139,"350":136.1513710873,"351":137.1527123045,"352":135.9630082863,"353":144.013299435,"354":145.5797413044,"355":146.4125266364,"356":145.5995745316,"357":143.2201610116,"358":143.6563942612,"359":142.8632653595,"360":146.1944158139,"361":141.3067454638,"362":135.883672741,"363":130.3119275362,"364":130.351561828,"365":131.0257303358,"366":127.9325060297,"367":128.6959121988,"368":132.1758004444,"369":132.7607109801,"370":134.4659562154,"371":138.5704202462,"372":139.7601181523,"373":136.1414717409,"374":135.4970381263,"375":132.6219367036,"376":134.4957008101,"377":135.7547942795,"378":139.869200352,"379":142.0503045015,"380":143.7555301957,"381":142.5459913642,"382":143.8051085582,"383":140.9002458504,"384":142.0205398078,"385":146.9280708604,"386":145.4409350366,"387":145.6491614819,"388":149.0794489953,"389":150.6359712067,"390":152.0933756508,"391":150.9730658882,"392":149.5057825433,"393":150.8541130294,"394":153.0847725049,"395":158.1311034337,"396":159.5091815026,"397":158.2599903631,"398":159.370391686,"399":163.0187713895,"400":161.825526389,"401":163.0168668036,"402":162.0737393341,"403":165.6974178974,"404":166.9781442758,"405":168.1794123439,"406":170.1153696309,"407":170.4231402812,"408":171.3265834178,"409":171.8725949014,"410":170.0756251397,"411":165.9356850588,"412":165.4492169767,"413":165.0521001169,"414":167.1369677818,"415":162.3814900428,"416":158.668436488,"417":156.5835713479,"418":156.0077480734,"419":153.5555357303,"420":153.8534034587,"421":152.5826210228,"422":152.5031844829,"423":151.5798728257,"424":153.6349669362,"425":158.1521944489,"426":152.2649069204,"427":152.5031853681,"428":150.289253016,"429":147.3009526672,"430":148.0256879416,"431":151.9770175215,"432":152.4932504819,"433":149.8226643203,"434":147.4895786071,"435":148.5617919743,"436":148.8695631706,"437":143.7963722511,"438":139.6663207803,"439":137.0056524871,"440":136.6979020164,"441":143.2205486044,"442":141.9795651105,"443":144.173647451,"444":138.4452241518,"445":137.5715875461,"446":137.2240582867,"447":137.1645049279,"448":133.401816351,"449":137.1942859168,"450":139.2593158368,"451":139.5968587496,"452":140.4804445456,"453":141.6221532746,"454":141.6221410355,"455":144.9480003533,"456":148.2838161407,"457":146.97330635,"458":143.0914974944,"459":146.754926332,"460":150.8253712622,"461":148.055462032,"462":143.9552179841,"463":137.7502500923,"464":133.6330584416,"465":134.9158770022,"466":136.7257871327,"467":133.8418731554,"468":138.7245903285,"469":143.5675143924,"470":146.6104987098,"471":147.7342245041,"472":146.4712742291,"473":145.3376274676,"474":149.1364111129,"475":146.8989050079,"476":146.1132800194,"477":148.5099059974,"478":146.3022253795,"479":142.5830230255,"480":139.5698807426,"481":139.7687506833,"482":145.7950785934,"483":144.840405927,"484":144.9597515687,"485":141.1311437596,"486":139.2218234242,"487":140.3157289554,"488":140.116821092,"489":140.2759168637,"490":143.4382637936,"491":140.3753628796,"492":135.2738832289,"493":132.9866658968,"494":130.590080012,"495":129.1680281594,"496":132.0121087703,"497":129.5757453444,"498":128.9193985397,"499":128.0045196931,"500":125.1703632577,"501":127.0200247284,"502":126.7216976921},"v":{"0":143301900,"1":97664900,"2":155088000,"3":109578200,"4":105158200,"5":100384500,"6":91951100,"7":88636800,"8":90221800,"9":111598500,"10":90757300,"11":104319500,"12":120150900,"13":114459400,"14":157611700,"15":98390600,"16":140843800,"17":142621100,"18":177523800,"19":106239800,"20":83305400,"21":89880900,"22":84183100,"23":75693800,"24":71297200,"25":76774200,"26":73046600,"27":64280000,"28":60145100,"29":80576300,"30":97918500,"31":96856700,"32":87668800,"33":103916400,"34":158273000,"35":111039900,"36":148199500,"37":164560400,"38":116307900,"39":102260900,"40":112966300,"41":178155000,"42":153766600,"43":154376600,"44":129525800,"45":111943300,"46":103026500,"47":88105100,"48":92403800,"49":115227900,"50":111932600,"51":121229700,"52":185549500,"53":111912300,"54":95467100,"55":88530500,"56":98844700,"57":94071200,"58":80819200,"59":85671900,"60":118323800,"61":75089100,"62":88651200,"63":80171300,"64":83466700,"65":88844600,"66":106686700,"67":91420000,"68":91266500,"69":87222800,"70":89347100,"71":84922400,"72":94264200,"73":94812300,"74":68847100,"75":84566500,"76":78657500,"77":66905100,"78":66015800,"79":107760100,"80":151101000,"81":109839500,"82":75135100,"83":137564700,"84":84000900,"85":78128300,"86":78973300,"87":88071200,"88":126142800,"89":112172300,"90":105861300,"91":81918000,"92":74244600,"93":63342900,"94":92612000,"95":76857100,"96":79295400,"97":63092900,"98":72009500,"99":56575900,"100":94625600,"101":71311100,"102":67637100,"103":59278900,"104":76229200,"105":75169300,"106":71057600,"107":74403800,"108":56877900,"109":71186400,"110":53522400,"111":96906500,"112":62746300,"113":91815000,"114":96721700,"115":108953300,"116":79663300,"117":74783600,"118":60214200,"119":68711000,"120":70783700,"121":62111300,"122":64556100,"123":63261400,"124":52485800,"125":78852600,"126":108181800,"127":104911600,"128":105575500,"129":99890800,"130":76299700,"131":100827100,"132":127050800,"133":106820300,"134":93251400,"135":121434600,"136":96350000,"137":74993500,"138":77338200,"139":71447400,"140":72434100,"141":104818600,"142":118931200,"143":56699500,"144":70440600,"145":62880000,"146":64786600,"147":56368300,"148":46397700,"149":54126800,"150":48908700,"151":69023100,"152":48493500,"153":72282600,"154":59375000,"155":103296000,"156":92229700,"157":86326000,"158":86960300,"159":60549600,"160":60131800,"161":48606400,"162":58991300,"163":48597200,"164":55802400,"165":90956700,"166":86453100,"167":80313700,"168":71115500,"169":57808700,"170":82278300,"171":74420200,"172":57305700,"173":140893200,"174":102404300,"175":109296300,"176":83281300,"177":68034100,"178":129868800,"179":123478900,"180":75834000,"181":76404300,"182":64838200,"183":53477900,"184":74150700,"185":108972300,"186":74602000,"187":89056700,"188":94639600,"189":98322000,"190":80861100,"191":83221100,"192":61732700,"193":58773200,"194":64452200,"195":73035900,"196":78762700,"197":69907100,"198":67940300,"199":85589200,"200":76378900,"201":58418800,"202":61421000,"203":58883400,"204":50720600,"205":60893400,"206":56094900,"207":100077900,"208":124953200,"209":74588300,"210":69122000,"211":54511500,"212":60394600,"213":65463900,"214":55020900,"215":56787900,"216":65187100,"217":41000000,"218":63804000,"219":59222800,"220":59256200,"221":88807000,"222":137827700,"223":117305600,"224":117467900,"225":96041900,"226":69463600,"227":76959800,"228":88748200,"229":174048100,"230":152052500,"231":136739200,"232":118023100,"233":107497000,"234":120405400,"235":116998900,"236":108923700,"237":115402700,"238":153237000,"239":139380400,"240":131063300,"241":150185800,"242":195432700,"243":107499100,"244":91185900,"245":92135300,"246":68356600,"247":74919600,"248":79144300,"249":62348900,"250":59773000,"251":64062300,"252":104487900,"253":99310400,"254":94537600,"255":96904000,"256":86709100,"257":106765600,"258":76138300,"259":74805200,"260":84505800,"261":80440800,"262":90956700,"263":94815000,"264":91420500,"265":122848900,"266":162294600,"267":115798400,"268":108275300,"269":121954600,"270":179935700,"271":115541600,"272":86213900,"273":84914300,"274":89418100,"275":82465400,"276":77251200,"277":74829200,"278":71285000,"279":90865900,"280":98670700,"281":86185500,"282":62527400,"283":61177400,"284":69589300,"285":82772700,"286":91162800,"287":90009200,"288":141147500,"289":91974200,"290":95056600,"291":83474400,"292":79724800,"293":76678400,"294":83737200,"295":96418800,"296":131148300,"297":91454900,"298":105342000,"299":96970100,"300":108732100,"301":92964300,"302":102300200,"303":75615400,"304":123511700,"305":95811400,"306":81532000,"307":98062700,"308":90131400,"309":80546200,"310":90371900,"311":100589400,"312":92633200,"313":103049300,"314":78751300,"315":76468400,"316":73401800,"317":89058800,"318":77594700,"319":76575500,"320":72246700,"321":79265200,"322":70618900,"323":75329400,"324":69023900,"325":67723800,"326":67929800,"327":87227800,"328":84882400,"329":96046400,"330":95623200,"331":88063200,"332":130216800,"333":131747600,"334":123055300,"335":88966500,"336":108256500,"337":130525300,"338":116124600,"339":131577900,"340":115366700,"341":142689800,"342":182602000,"343":113990900,"344":86643800,"345":78336300,"346":109742900,"347":136095600,"348":137426100,"349":117726300,"350":104132700,"351":92482700,"352":90601500,"353":90978500,"354":103718400,"355":74286600,"356":72348100,"357":88570300,"358":71598400,"359":67808200,"360":53950200,"361":69473000,"362":91437900,"363":122207100,"364":84784300,"365":91533000,"366":108123900,"367":134520300,"368":81000500,"369":73409200,"370":72433800,"371":89116800,"372":70207900,"373":67083400,"374":66242400,"375":98964500,"376":71051600,"377":73353800,"378":74064300,"379":66253700,"380":64547800,"381":63141600,"382":77588800,"383":71185600,"384":78140700,"385":76259900,"386":81420900,"387":82982400,"388":64823400,"389":65086600,"390":66675400,"391":53623900,"392":55138700,"393":78620700,"394":81378700,"395":101786900,"396":67829400,"397":59907000,"398":82507500,"399":55474100,"400":56697000,"401":60276900,"402":63135500,"403":70170500,"404":57149200,"405":68039400,"406":54091700,"407":56377100,"408":79542000,"409":62290100,"410":70346300,"411":69026800,"412":54147100,"413":53841500,"414":51218200,"415":78961000,"416":73314000,"417":77906200,"418":87991100,"419":74229900,"420":76957800,"421":73714800,"422":87449600,"423":84923800,"424":68028800,"425":104956000,"426":122656600,"427":87965400,"428":90481100,"429":162278800,"430":81474200,"431":107689800,"432":101696800,"433":86652500,"434":96029900,"435":93339400,"436":84442700,"437":146691400,"438":128138200,"439":124925300,"440":114311700,"441":87830100,"442":79471000,"443":68402200,"444":85925600,"445":74899000,"446":77033700,"447":70433700,"448":113224000,"449":88598000,"450":85250900,"451":99136600,"452":61758300,"453":64522000,"454":86548600,"455":75981900,"456":74732300,"457":88194300,"458":109180200,"459":164762400,"460":97943200,"461":80379300,"462":93604600,"463":97918500,"464":140814800,"465":83374600,"466":89908500,"467":74917800,"468":118854000,"469":93979700,"470":73374100,"471":89868300,"472":64218300,"473":80389400,"474":74829600,"475":58724100,"476":51804100,"477":58301400,"478":35195900,"479":69246000,"480":83763800,"481":111380900,"482":71250400,"483":65447400,"484":68826400,"485":64727200,"486":69721100,"487":62128300,"488":76097000,"489":70462700,"490":93886200,"491":82291200,"492":98931900,"493":160156900,"494":79592600,"495":77432800,"496":85928000,"497":77852100,"498":63814900,"499":69007800,"500":85438400,"501":75703700,"502":77034200}}
        self.df = pd.DataFrame(self.data_2021_01_01_2023_01_01).reset_index(drop=True)
        self.df["t"] = pd.to_datetime(self.df["t"], unit="ms")
        self.filenames = []
    
    def tearDown(self):
        for filename in self.filenames:
            try:
                os.remove(filename)
            except OSError as oserr:
                print(oserr)

    @patch('data_collection.historical_data.yf.Ticker')
    def test_get_historical_data(self, yf_ticker: MagicMock):
        ticker_mock = MagicMock(spec=Ticker)
        ticker_mock.history.return_value = self.df
        yf_ticker.return_value = ticker_mock

        filename = os.path.join(CACHE_DIR, _args_to_filename("FAKE", "2021-01-01", "2023-01-01", "1d", "", False))
        self.filenames.append(filename)
        df = get_historical_data("FAKE", "2021-01-01", "2023-01-01", "1d", "", False)

        self.assertTrue(self.df.equals(df))
        self.assertTrue(os.path.isfile(filename))
        yf_ticker.assert_called_once_with("FAKE")
        ticker_mock.history.assert_called_once_with(start="2021-01-01", end="2023-01-01", prepost=False, interval="1d")

        # call again with same args, should use cache and not call broker
        df = get_historical_data("FAKE", "2021-01-01", "2023-01-01", "1d", "", False)
        self.assertTrue(self.df.equals(df))
        self.assertTrue(os.path.isfile(filename))
        ticker_mock.history.assert_called_once_with(start="2021-01-01", end="2023-01-01", prepost=False, interval="1d")
        yf_ticker.assert_called_once_with("FAKE")

        # call again with smaller date range, should use cache and not call broker
        df = get_historical_data("FAKE", "2021-01-05", "2021-01-08", "1d", "", False)
        self.assertTrue(self.df.iloc[1:4].reset_index(drop=True).equals(df))
        self.assertTrue(os.path.isfile(filename))
        ticker_mock.history.assert_called_once_with(start="2021-01-01", end="2023-01-01", prepost=False, interval="1d")
        yf_ticker.assert_called_once_with("FAKE")


if __name__ == "__main__":
    unittest.main()